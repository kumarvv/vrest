<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>vREST by kumarvv</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">vREST</h1>
        <p class="header">Single Class REST Server using Java SE </p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/kumarvv/vrest/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/kumarvv/vrest/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/kumarvv/vrest">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/kumarvv">kumarvv</a></p>


      </header>
      <section>
        <h1>
<a name="vrest" class="anchor" href="#vrest"><span class="octicon octicon-link"></span></a>vREST</h1>

<p>Simple single class REST server using Java SE only.</p>

<ul>
<li>Jave SE 1.6 or above </li>
<li>No HTTP server / servlet container required </li>
<li>Uses Java SE socket to listen and process client requests</li>
<li>Multi-threaded request processing (100 threads by default)</li>
<li>Uses jackson mapper (org.codehaus.jackson) for JSON processing</li>
<li>Automatic scanning of all REST resources in current classpath (no configurations required)</li>
</ul><p><strong>Limitations:</strong> </p>

<ul>
<li>Not a production ready server (for quick REST services testing only) </li>
<li>supports JSON data communications only </li>
</ul><h2>
<a name="setup" class="anchor" href="#setup"><span class="octicon octicon-link"></span></a>Setup</h2>

<p>Download or checkout and run following maven command: </p>

<div class="highlight highlight-bash"><pre><span class="nv">$ </span>mvn compile
<span class="nv">$ </span>mvn <span class="nb">exec</span>:exec -DRESTServer
</pre></div>

<p>This command should scan all the classes in current directory for REST resources and listens on 4001 port: </p>

<div class="highlight highlight-bash"><pre><span class="nv">$ </span>mvn <span class="nb">exec</span>:exec -DRESTServer
<span class="o">[</span>INFO<span class="o">]</span> Scanning <span class="k">for</span> projects...
...
<span class="o">[</span>INFO<span class="o">]</span> --- <span class="nb">exec</span>-maven-plugin:1.3.2:exec <span class="o">(</span>default-cli<span class="o">)</span> @ vjrest ---
INFO: scanning resources...
INFO: Found api: CityResource.delete <span class="o">=</span>&gt; /cities/:city
INFO: Found api: CityResource.all <span class="o">=</span>&gt; /cities
INFO: Found api: CityResource.create <span class="o">=</span>&gt; /cities/new
INFO: Found api: CityResource.update <span class="o">=</span>&gt; /cities/:city
INFO: Found api: CityResource.getCity <span class="o">=</span>&gt; /cities/:city
INFO: Found api: CityResource.echo <span class="o">=</span>&gt; /echo/:str
INFO: Found api: CityResource.getRequestParams <span class="o">=</span>&gt; /params
INFO: scanning completed.
INFO: starting server...
INFO: listening on http://localhost:4001

</pre></div>

<h2>
<a name="usage-" class="anchor" href="#usage-"><span class="octicon octicon-link"></span></a>Usage: </h2>

<p>Import static properties from RESTServer class and add <code>@Resource</code> annotation with path to any POJO (or non-POJO) classes: </p>

<div class="highlight highlight-java"><pre><span class="kn">import</span> <span class="nn">static</span> <span class="n">com</span><span class="o">.</span><span class="na">kumarvv</span><span class="o">.</span><span class="na">vrest</span><span class="o">.</span><span class="na">RESTServer</span><span class="o">.*;</span>

<span class="nd">@Resource</span><span class="o">(</span><span class="s">"/cities"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CityResource</span> <span class="o">{</span>
<span class="o">...</span>
</pre></div>

<p>Add <code>@GET</code> (or <code>@POST, @PUT, @UPDATE</code>) annotation to the class method. This annotation also supports resource path to append to class resource path. </p>

<div class="highlight highlight-java"><pre><span class="nd">@GET</span>
<span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">City</span><span class="o">&gt;</span> <span class="nf">all</span><span class="o">()</span> <span class="o">{</span>
<span class="o">...</span>

<span class="nd">@GET</span><span class="o">(</span><span class="s">"favorties"</span><span class="o">)</span>  <span class="c1">// resolves to "/cities/favorites"</span>
<span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">City</span><span class="o">&gt;</span> <span class="nf">favorites</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">cities</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>

<p>Add <code>@Param</code> to inject request or url parameter value to method arguments: </p>

<div class="highlight highlight-java"><pre><span class="nd">@GET</span><span class="o">(</span><span class="s">":city"</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">City</span> <span class="nf">getCity</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"city"</span><span class="o">)</span> <span class="n">String</span> <span class="n">cityCode</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">cities</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">cityCode</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>

<p>Request using <code>/cities/NYC</code> url will pass the <code>NYC</code> value to <code>cityCode</code> method argument. 
Add <code>@Data</code> to inject request payload (form-data) to method argument: </p>

<div class="highlight highlight-java"><pre><span class="nd">@PUT</span><span class="o">(</span><span class="s">":city"</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">City</span> <span class="nf">update</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"city"</span><span class="o">)</span> <span class="n">String</span> <span class="n">cityCode</span><span class="o">,</span> <span class="nd">@Data</span> <span class="n">City</span> <span class="n">upd</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">City</span> <span class="n">city</span> <span class="o">=</span> <span class="n">cities</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">cityCode</span><span class="o">);</span>
<span class="o">...</span>
</pre></div>

<h2>
<a name="sample-rest-resource-class-" class="anchor" href="#sample-rest-resource-class-"><span class="octicon octicon-link"></span></a>Sample REST Resource class: </h2>

<div class="highlight highlight-java"><pre><span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">static</span> <span class="n">com</span><span class="o">.</span><span class="na">kumarvv</span><span class="o">.</span><span class="na">vrest</span><span class="o">.</span><span class="na">RESTServer</span><span class="o">.*;</span>

<span class="cm">/**</span>
<span class="cm"> * Sample request with full CRUD</span>
<span class="cm"> */</span>
<span class="nd">@Resource</span><span class="o">(</span><span class="s">"/cities"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CityResource</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">City</span><span class="o">&gt;</span> <span class="n">cities</span><span class="o">;</span>
    <span class="kd">static</span> <span class="o">{</span>
        <span class="n">cities</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">City</span><span class="o">&gt;();</span>
        <span class="n">cities</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"NYC"</span><span class="o">,</span> <span class="k">new</span> <span class="nf">City</span><span class="o">(</span><span class="s">"NYC"</span><span class="o">,</span> <span class="s">"New York"</span><span class="o">));</span>
        <span class="n">cities</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"LAX"</span><span class="o">,</span> <span class="k">new</span> <span class="nf">City</span><span class="o">(</span><span class="s">"LAX"</span><span class="o">,</span> <span class="s">"Los Angeles"</span><span class="o">));</span>
        <span class="n">cities</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"SFO"</span><span class="o">,</span> <span class="k">new</span> <span class="nf">City</span><span class="o">(</span><span class="s">"SFO"</span><span class="o">,</span> <span class="s">"San Francisco"</span><span class="o">));</span>
        <span class="n">cities</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"BOS"</span><span class="o">,</span> <span class="k">new</span> <span class="nf">City</span><span class="o">(</span><span class="s">"BOS"</span><span class="o">,</span> <span class="s">"Boston"</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="nd">@GET</span>
    <span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">City</span><span class="o">&gt;</span> <span class="nf">all</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">cities</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@GET</span><span class="o">(</span><span class="s">":city"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">City</span> <span class="nf">getCity</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"city"</span><span class="o">)</span> <span class="n">String</span> <span class="n">cityCode</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">cities</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">cityCode</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@POST</span><span class="o">(</span><span class="s">"new"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">City</span> <span class="nf">create</span><span class="o">(</span><span class="nd">@Data</span> <span class="n">City</span> <span class="n">city</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">city</span><span class="o">.</span><span class="na">setCreatedAt</span><span class="o">(</span><span class="k">new</span> <span class="nf">Date</span><span class="o">());</span>
        <span class="n">cities</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">city</span><span class="o">.</span><span class="na">getCode</span><span class="o">(),</span> <span class="n">city</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">city</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@PUT</span><span class="o">(</span><span class="s">":city"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">City</span> <span class="nf">update</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"city"</span><span class="o">)</span> <span class="n">String</span> <span class="n">cityCode</span><span class="o">,</span> <span class="nd">@Data</span> <span class="n">City</span> <span class="n">upd</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">City</span> <span class="n">city</span> <span class="o">=</span> <span class="n">cities</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">cityCode</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">city</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">city</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">upd</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
            <span class="n">city</span><span class="o">.</span><span class="na">setUpdatedAt</span><span class="o">(</span><span class="k">new</span> <span class="nf">Date</span><span class="o">());</span>
            <span class="n">cities</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">city</span><span class="o">.</span><span class="na">getCode</span><span class="o">(),</span> <span class="n">city</span><span class="o">);</span>
            <span class="k">return</span> <span class="n">city</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@DELETE</span><span class="o">(</span><span class="s">":city"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">delete</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"city"</span><span class="o">)</span> <span class="n">String</span> <span class="n">cityCode</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">cities</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">cityCode</span><span class="o">);</span>
        <span class="k">return</span> <span class="s">"City ["</span> <span class="o">+</span> <span class="n">cityCode</span> <span class="o">+</span> <span class="s">"] deleted successfully"</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@GET</span><span class="o">(</span><span class="s">"/echo/:str"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">echo</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"str"</span><span class="o">)</span> <span class="n">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"echo: "</span> <span class="o">+</span> <span class="n">str</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@GET</span><span class="o">(</span><span class="s">"/params"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="nf">getRequestParams</span><span class="o">(</span><span class="nd">@Params</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">params</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">params</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>

<p>This class generates REST resources in following context paths: </p>

<pre><code>GET /cities          =&gt; maps to CityResource.all() 
GET /cities/:city    =&gt; maps to CityResource.getCity()
POST /cities/new     =&gt; maps to CityResource.create() 
PUT /cities/:city    =&gt; maps to CityResource.update() 
DELETE /cities/:city =&gt; maps to CityResource.delete() 
GET /echo/:str       =&gt; maps to CityResource.echo() 
GET /params          =&gt; maps to CityResource.getRequestParams()
</code></pre>

<p>Note on <code>/echo/:str</code>, starting with <code>/</code> in <code>@GET("/echo/:str")</code> makes the resource to be at root bypassing the <code>@Resource</code> annotation at class level. All other resources have <code>/cities</code> as prefix from <code>@Resource</code> annotation. </p>

<h2>
<a name="sample-requestresponse-" class="anchor" href="#sample-requestresponse-"><span class="octicon octicon-link"></span></a>Sample Request/Response: </h2>

<p>GET request of <code>http://localhost:4001/cities/NYC</code> will return following json: </p>

<div class="highlight highlight-json"><pre><span class="p">{</span>
    <span class="nt">"code"</span><span class="p">:</span> <span class="s2">"NYC"</span><span class="p">,</span>
    <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"New York"</span><span class="p">,</span>
    <span class="nt">"created"</span><span class="p">:</span> <span class="s2">"Sun Jul 18 13:24:12 EDT 2014"</span><span class="p">,</span>
    <span class="nt">"updated"</span><span class="p">:</span> <span class="s2">"Sun Jul 18 13:24:34 EDT 2014"</span>
<span class="p">}</span>
</pre></div>
      </section>
      <footer>
        <p><small>Hosted on <a href="http://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>
